server {
    listen 80;
    server_name ulizko.com *.ulizko.com;

    if ($request_method !~ ^(GET|HEAD)$ ) {
         return 444;
    }

    if ($request_filename ~ posts\/(\d+)$) {
        rewrite ^(.*)$ $1/index.html permanent;
    }

    if ($request_filename ~ (russify_comments_number|about|contacts)$) {
        rewrite ^(.*)$ $1.html permanent;
    }

    

    location ~* \.(jp?g|gif|png|css|js|swf|flv|mp3|zip|txt|ttf|html)$ {
            gzip on;
            gzip_vary on;
            gzip_comp_level 5;
            gzip_proxied any;
            gzip_types text/plain text/css application/x-javascript text/xml application/xml application/xml+rss text/javascript application/x-font;
            root /var/www/ulizko;
            access_log off;
            add_header  Cache-Control public;
            expires max;
    }

    location ~* \.(html)$ {
            gzip on;
            gzip_vary on;
            gzip_comp_level 5;
            gzip_proxied any;
            root /var/www/ulizko;
            add_header  Cache-Control public;
            expires 1h;
    }

    location / {
        gzip on;
        gzip_vary on;
        gzip_comp_level 5;
        gzip_proxied any;
        root   /var/www/ulizko;
        index  index.html;
    }
    

    error_page  404  /404.html;

    location /404.html {
        root /var/www/ulizko;
    }
}
